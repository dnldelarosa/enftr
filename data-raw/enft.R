library(dplyr)

conn <- Dmisc::db_connect(db_name = "enft")
enft_r <- tbl(conn, "enft")

rows_slice <- c(451336L, 267216L, 686590L, 902514L, 875091L, 589255L, 733171L, 
                140908L, 64950L, 112241L, 797904L, 372521L, 432123L, 268057L, 
                619789L, 573908L, 568532L, 925170L, 835012L, 795670L, 498719L, 
                449661L, 126435L, 65319L, 56877L, 251568L, 468744L, 31622L, 829601L, 
                887742L, 683540L, 785208L, 785107L, 13051L, 218648L, 113450L, 
                702765L, 190867L, 865143L, 645035L, 568103L, 727686L, 616033L, 
                390086L, 131201L, 754086L, 834315L, 401615L, 413993L, 303032L, 
                251061L, 29351L, 490298L, 711754L, 596377L, 929658L, 378822L, 
                509777L, 705059L, 242812L, 777981L, 873632L, 308550L, 509712L, 
                874659L, 311959L, 488491L, 282796L, 696138L, 753549L, 814122L, 
                647791L, 99522L, 105070L, 518379L, 652449L, 61577L, 483237L, 
                455441L, 792574L, 792077L, 83684L, 721140L, 461889L, 249053L, 
                435819L, 103826L, 915352L, 394846L, 140457L, 299237L, 479235L, 
                79346L, 138827L, 215936L, 855883L, 933946L, 709069L, 800947L, 
                53824L, 434438L, 459792L, 722716L, 167534L, 62916L, 578541L, 
                95337L, 714225L, 684604L, 163586L, 585693L, 112143L, 277424L, 
                150293L, 200008L, 429142L, 120372L, 554783L, 746002L, 375539L, 
                841376L, 444867L, 388054L, 403789L, 620941L, 870064L, 639853L, 
                34992L, 55687L, 657482L, 434493L, 579779L, 832914L, 60634L, 30830L, 
                619640L, 576988L, 159016L, 781410L, 285823L, 215299L, 795499L, 
                714785L, 902016L, 377756L, 731857L, 364781L, 842499L, 875371L, 
                852641L, 70924L, 855661L, 845657L, 640247L, 608434L, 677453L, 
                53403L, 908480L, 82012L, 153666L, 473167L, 27895L, 338178L, 535964L, 
                425394L, 687848L, 282359L, 159117L, 103231L, 766281L, 455668L, 
                523933L, 208804L, 443469L, 860045L, 585389L, 406202L, 564976L, 
                180803L, 754091L, 638281L, 652153L, 340460L, 179013L, 780482L, 
                216051L, 635790L, 384359L, 756521L, 122184L, 225377L, 684060L, 
                792370L, 340693L, 197585L, 474246L, 652439L, 96497L, 6593L, 542803L, 
                857363L, 921861L, 709371L, 615087L, 901176L, 476146L, 725784L, 
                14032L, 339195L, 556594L, 644852L, 99443L, 66946L, 385422L, 232393L, 
                616361L, 129816L, 775046L, 416442L, 408699L, 791130L, 448911L, 
                190184L, 581546L, 246394L, 564480L, 563719L, 414708L, 737241L, 
                501986L, 477014L, 143189L, 897346L, 194727L, 533101L, 168449L, 
                850587L, 781228L, 906291L, 254894L, 318603L, 683101L, 341650L, 
                746193L, 791380L, 249683L, 161095L, 328321L, 467685L, 239228L, 
                514219L, 42352L, 598145L, 80355L, 196537L, 191668L, 499810L, 
                621246L, 313601L, 871174L, 295635L, 841083L, 721809L, 719212L, 
                561734L, 43317L, 769467L, 606638L, 729506L, 534611L, 112366L, 
                728311L, 95879L, 659925L, 42661L, 478728L, 341511L, 367582L, 
                778057L, 592802L, 741037L, 719106L, 308958L, 261855L, 136373L, 
                233388L, 339510L, 780495L, 830826L, 324619L, 447821L, 725783L, 
                397798L, 918204L, 152746L, 87561L, 336447L, 500954L, 695156L, 
                899310L, 632098L, 568341L, 701291L, 344620L, 121017L, 449779L, 
                428004L, 493487L, 644488L, 806163L, 576565L, 918813L, 606006L, 
                334447L, 647248L, 337332L, 873937L, 746009L, 582159L, 570534L, 
                882406L, 277754L, 161058L, 393537L, 709723L, 414775L, 495602L, 
                604702L, 326290L, 191199L, 911772L, 146678L, 367530L, 678408L, 
                581158L, 430468L, 635429L, 683890L, 606297L, 105454L, 764617L, 
                797462L, 33486L, 23321L, 117337L, 171506L, 712033L, 231636L, 
                754109L, 233288L, 241528L, 53168L, 685300L, 384398L, 112852L, 
                811065L, 42137L, 276779L, 350562L, 614L, 80089L, 64563L, 460118L, 
                495651L, 932227L, 813734L, 566143L, 731298L, 863283L, 425145L, 
                200865L, 724352L, 874836L, 88637L, 593452L, 598589L, 296363L, 
                529855L, 1295L, 76069L, 760182L, 599241L, 420358L, 209778L, 903620L, 
                894065L, 64325L, 515497L, 234631L, 856100L, 613919L, 382075L, 
                509673L, 324809L, 326211L, 931619L, 194571L, 158329L, 234853L, 
                175128L, 307933L, 697770L, 82997L, 149649L, 434024L, 81242L, 
                701163L, 568394L, 544386L, 879373L, 819975L, 916189L, 276633L, 
                543028L, 259012L, 331726L, 122809L, 593701L, 369112L, 295847L, 
                220364L, 11315L, 500914L, 2036L, 872498L, 451180L, 80851L, 222962L, 
                232881L, 580722L, 452269L, 417296L, 571945L, 119369L, 586547L, 
                12304L, 916527L, 377662L, 580009L, 795677L, 872787L, 817377L, 
                14607L, 936081L, 926006L, 167041L, 58355L, 411462L, 395376L, 
                831897L, 439074L, 769000L, 393311L, 784494L, 306525L, 304891L, 
                204313L, 437230L, 539063L, 300389L, 553492L, 819547L, 901237L, 
                621136L, 478994L, 354926L, 877264L, 741289L, 841171L, 494078L, 
                741182L, 633337L, 871747L, 719095L, 793420L, 815024L, 776373L, 
                607088L, 748382L, 567514L, 206777L, 710472L, 3363L, 855177L, 
                78794L, 851282L, 615781L, 784931L, 288625L, 543264L, 543834L, 
                574064L, 404613L, 446254L, 211572L, 885239L, 13602L, 854950L, 
                650905L, 49753L, 11001L, 466325L, 491498L, 878335L, 98140L, 691898L, 
                46059L, 269995L, 196182L, 857964L, 726585L, 223286L, 816862L, 
                37984L, 816330L, 420437L, 706161L, 684086L, 550512L, 2572L, 284901L, 
                666797L, 789006L, 50136L, 829148L, 330963L, 147869L, 227049L, 
                802507L, 691839L, 412598L, 650258L, 766802L, 154628L, 174640L, 
                612135L, 383904L, 55864L, 288542L, 655083L, 755829L, 631402L, 
                820505L, 786831L, 499956L, 851920L, 386376L, 232676L, 490652L, 
                297406L, 675344L, 905592L, 809317L, 326393L, 349480L, 607156L, 
                538538L, 691059L, 773850L, 257044L, 49530L, 262922L, 389136L, 
                892927L, 720940L, 476438L, 716502L, 536244L, 413114L, 202474L, 
                495775L, 305651L, 203755L, 581028L, 427372L, 142218L, 486194L, 
                243943L, 848184L, 672733L, 183983L, 332193L, 612385L, 279269L, 
                300526L, 457218L, 906824L, 876839L, 399414L, 208546L, 489101L, 
                393620L, 935856L, 253547L, 581830L, 75718L, 695148L, 798317L, 
                15029L, 312842L, 310768L, 283573L, 842485L, 852199L, 483117L, 
                911379L, 192705L, 708135L, 691832L, 365703L, 347895L, 204796L, 
                607612L, 94473L, 594774L, 223081L, 526695L, 731011L, 727130L, 
                541904L, 317665L, 734167L, 388325L, 595354L, 811116L, 674120L, 
                215357L, 720966L, 858151L, 901174L, 455155L, 141807L, 546136L, 
                462186L, 148030L, 631830L, 14126L, 826034L, 881753L, 593197L, 
                10600L, 919955L, 664038L, 651670L, 407561L, 868738L, 10962L, 
                771518L, 311368L, 702295L, 895484L, 651561L, 825422L, 630729L, 
                281357L, 494719L, 772215L, 636665L, 102387L, 153589L, 427956L, 
                219861L, 704049L, 414672L, 467323L, 865094L, 394354L, 550671L, 
                607502L, 428697L, 341554L, 124991L, 754479L, 733548L, 400110L, 
                402838L, 314295L, 733966L, 656352L, 444370L, 113070L, 778856L, 
                416572L, 639551L, 165809L, 656136L, 907951L, 929614L, 327142L, 
                124305L, 911054L, 588292L, 562487L, 218122L, 658546L, 374855L, 
                802061L, 911901L, 99904L, 812660L, 251883L, 213396L, 524012L, 
                287052L, 736975L, 40852L, 266421L, 556672L, 47686L, 468885L, 
                581155L, 681402L, 383387L, 372790L, 38022L, 56781L, 23578L, 455973L, 
                734700L, 584795L, 729977L, 636773L, 584771L, 492805L, 468662L, 
                907584L, 838019L, 213144L, 38818L, 260094L, 31301L, 272907L, 
                447534L, 693149L, 141198L, 688502L, 921715L, 409624L, 80401L, 
                97408L, 131169L, 770465L, 484840L, 858907L, 30077L, 127957L, 
                924099L, 705961L, 394719L, 5207L, 250391L, 735759L, 203672L, 
                782945L, 481592L, 367257L, 224118L, 711387L, 432754L, 248840L, 
                249395L, 696610L, 777397L, 833969L, 110784L, 873166L, 446992L, 
                677694L, 210002L, 558254L, 164493L, 608893L, 410136L, 477728L, 
                402818L, 660323L, 202094L, 200992L, 885312L, 808978L, 10764L, 
                839858L, 24629L, 5265L, 487495L, 834896L, 332913L, 667620L, 494641L, 
                933767L, 232647L, 642792L, 38428L, 239711L, 812524L, 643040L, 
                308790L, 37495L, 912669L, 304448L, 545030L, 356206L, 158928L, 
                561772L, 445360L, 370499L, 115994L, 746662L, 358839L, 511324L, 
                335117L, 187100L, 724561L, 55005L, 644373L, 460237L, 41739L, 
                885019L, 337710L, 527766L, 209355L, 904836L, 731150L, 422446L, 
                636822L, 197149L, 198713L, 13990L, 348010L, 737044L, 84556L, 
                226700L, 641944L, 750328L, 608055L, 245629L, 382900L, 225671L, 
                833349L, 687556L, 419143L, 667192L, 663766L, 50970L, 923287L, 
                787821L, 833787L, 332846L, 782916L, 190998L, 858826L, 791880L, 
                687617L, 102537L, 619081L, 751450L, 542857L, 62411L, 739382L, 
                237150L, 743725L, 79308L, 279024L, 198831L, 161235L, 36142L, 
                764222L, 714681L, 199813L, 18958L, 3312L, 892187L, 654642L, 577269L, 
                285452L, 421943L, 368625L, 161987L, 37538L, 378932L, 596669L, 
                64022L, 220390L, 64462L, 555169L, 869890L, 850655L, 713573L, 
                545497L, 490255L, 224380L, 862039L, 398120L, 706274L, 639452L, 
                206228L, 922023L, 621887L, 54201L, 541634L, 869276L, 75561L, 
                182516L, 320146L, 343660L, 493844L, 252208L, 897770L, 740692L, 
                572816L, 463170L, 260807L, 299478L, 76727L, 175553L, 868326L, 
                890281L, 860572L, 303406L, 686097L, 316015L, 866832L, 445874L, 
                415513L, 228570L, 631631L, 845985L, 443165L, 725233L, 76142L, 
                32199L, 305299L, 633404L, 336555L, 155309L, 563023L, 466667L, 
                309518L, 626429L, 697045L, 44988L, 48147L, 788590L, 716125L, 
                327881L, 837428L, 524889L, 793097L, 87438L, 152736L, 414310L, 
                794894L, 530393L, 560937L, 724459L, 371455L, 288955L, 767331L, 
                426161L, 723517L, 218103L, 502084L, 251875L, 639312L, 797671L, 
                545322L, 255279L, 631159L, 693392L, 191512L, 765970L, 279350L, 
                585438L, 654800L, 33158L, 122882L, 77959L, 922103L, 289695L, 
                200981L, 195021L, 768302L, 339782L, 785167L, 874274L, 886046L, 
                487634L, 426850L, 896832L, 533199L, 237928L, 924157L, 555342L, 
                789629L, 884524L, 184902L, 566836L, 146311L, 822500L, 191947L
)

enft_r <- enft_r %>% 
  filter(dplyr::row_number() %in% rows_slice) %>% 
  collect()

enft_like <- enft_r %>% 
  select(
    EFT_PERIODO, EFT_VIVIENDA, EFT_HOGAR, EFT_MIEMBRO, EFT_EDAD, EFT_TRABAJO_SEM_ANT,
    EFT_TUVO_ACT_ECON_SEM_ANT, EFT_CULTIVO_SEM_ANT, EFT_ELAB_PROD_SEM_ANT,
    EFT_AYUDO_FAM_SEM_ANT, EFT_AYUDO_FAM_SEM_ANT, EFT_COSIO_LAVO_SEM_ANT,
    EFT_BUSCO_TRAB_SEM_ANT, EFT_BUSCO_TRAB_MES_ANT, EFT_TRABAJO_ANTES,
    EFT_TIENE_COND_JORNADA, EFT_OCUPACION_PRINC, EFT_CATEGORIA_OCUP_PRINC,
    EFT_CANT_PERS_TRAB, EFT_HORAS_SEM_OCUP_PRINC, EFT_PERIODO_ING_OCUP_PRINC,
    EFT_ING_OCUP_PRINC, EFT_DIAS_SEM_OCUP_PRINC, EFT_PROVINCIA, EFT_ZONA,
    EFT_FACTOR_EXP_ANUAL, EFT_FACTOR_EXP, EFT_SEXO
    )

usethis::use_data(enft_like, overwrite = TRUE)
